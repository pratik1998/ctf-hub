import requests
from mt19937predictor import MT19937Predictor

session = requests.Session()

predictor = MT19937Predictor()

# Get the flag
time = -1
while True:
    r = session.get("http://52.59.124.14:10012/")
    # print(r.text)
    arr = r.text.split("\n")
    if time == -1:
        time = int(arr[0])
    if time != -1 and time + 60 < int(arr[0]):
        break
    for i in range(1, len(arr)):
        if arr[i].isdigit():
            predictor.setrandbits(int(arr[i]), 32)
    next = predictor.getrandbits(32)
    print(next)
    r = session.post("http://52.59.124.14:10012/submit", data={"next": next})
    print(r.text)
    if "FLAG" in r.text:
        print(r.text)
        break